<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>2026 ì „ë„ì¸ ìˆ˜ë ¨íšŒ ì°¨ëŸ‰ìš´ì˜</title>
    
    <!-- CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body { 
            font-family: 'Pretendard', sans-serif;
            -webkit-tap-highlight-color: transparent;
            letter-spacing: -0.02em;
            background-color: #f8fafc;
        }
        .bus-container {
            background: #ffffff;
            border: 4px solid #e2e8f0;
            border-radius: 40px;
            padding: 20px;
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1);
            position: relative;
        }
        .bus-head {
            height: 60px;
            border-bottom: 2px dashed #cbd5e1;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 10px;
        }
        .seat {
            width: 100%;
            height: 38px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 800;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            cursor: pointer;
        }
        .seat-occupied {
            background-color: #fbbf24;
            color: #1e293b;
            border: 1px solid #d97706;
            box-shadow: inset 0 -2px 0 rgba(0,0,0,0.1);
        }
        .seat-highlight {
            background-color: #3b82f6 !important;
            color: white !important;
            border-color: #1d4ed8 !important;
            transform: scale(1.1);
            z-index: 20;
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.6);
        }
        .seat-empty {
            background-color: #f1f5f9;
            border: 1px solid #e2e8f0;
            color: transparent;
        }
        .aisle {
            width: 24px;
        }
        .animate-pop { animation: pop 0.3s cubic-bezier(0.34, 1.56, 0.64, 1); }
        @keyframes pop { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        
        @media (max-width: 640px) {
            .seat { height: 34px; font-size: 10px; }
        }
    </style>
</head>
<body class="text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        const TIME_OPTIONS = [
            '2/23(ì›”) ì˜¤ì „', '2/23(ì›”) ì˜¤í›„', '2/23(ì›”) ì €ë…',
            '2/24(í™”) ìƒˆë²½', '2/24(í™”) ì˜¤ì „', '2/24(í™”) ì˜¤í›„', '2/24(í™”) ì €ë…',
            '2/25(ìˆ˜) ì˜¤ì „'
        ];

        // --- ì´ˆê¸° ë°ì´í„° ì „ìˆ˜ ë³µêµ¬ ---
        const generateInitialData = () => {
            const data = [];
            const now = Date.now();

            // ë²„ìŠ¤ 1í˜¸ì°¨ (40ëª…)
            const b1 = ["ìœ¤í•´ê¶Œ", "ë°°í˜„ê¸°", "ì†¡ê¸°í˜¸", "ì„œì˜ì§„", "ê³µí˜„ì• ", "ë…¸ë¯¼ìˆ™", "ë°•ìˆœ", "ê¹€ìœ¤í¬", "ìµœì •ìˆ™", "ê¹€ì§„í¬", "ë°•ì˜ì", "ì´ëª…ìˆ™", "ê¹€ìˆ™í¬", "ì´í˜œë ¹", "ì´ì€ì", "ì´ìˆœë¡€", "ê¹€ì• ìˆ™", "ì •ì˜ë€", "ë°±ì¢…ë¯¸", "ì´ìˆœí¬", "ì •ë™ê·œ", "ì´ì •í¬", "ì‹ íš¨ì„±", "ë°•ì˜ë¯¸", "ê¹€ë‹¤ìš´", "ë°•ë¯¸ìˆœ", "ì–‘ë€í¬", "ì•ˆìƒì•„", "í•œì€ê²½", "ì¡°ê´‘ìˆœ", "í—ˆê²½ì‹¬", "ë…¸ì—°ë¯¸", "ê¹€ì—°í™”", "ë¬¸ì¶˜ì", "ìœ¤ë¯¸ì• ", "ê¹€ì• ë€", "ë°•ë³µìˆœ", "ê¹€ìˆ™ì˜", "ì´ë¯¸ê²½", "ì´ê°•ì"];
            b1.forEach((n, i) => {
                const isRight = i >= 20;
                const seat = (Math.floor((i % 20) / 2) * 4) + (isRight ? 2 : 0) + (i % 2);
                data.push({ id: `b1-${i}`, name: n, vehicleType: 'ë²„ìŠ¤ 1í˜¸ì°¨', departure: '2/23(ì›”) ì˜¤ì „', return: '2/25(ìˆ˜) ì˜¤ì „', seatPosition: seat, groupId: 'bus1' });
            });

            // ë²„ìŠ¤ 2í˜¸ì°¨ (38ëª…)
            const b2 = ["ì–‘íšŒìˆœ", "ì´ì–‘í˜¸", "ì´ì¶˜ì„ ", "ê¹€ì„ì˜¥", "ë¬¸ì •ì˜¥", "í™©ì—°ìˆ™", "ìµœì€í¬", "ì´ë¯¸ìˆ™", "ì–‘í¬ê²½", "ê°•ì •ì¸", "ê¹€ì†Œì˜", "ìë…€1", "ê¹€ì¸ìˆ™", "í™©ì¬í–¥", "ì•ˆìœ¤ë¯¸", "ìë…€1", "ì´íš¨ì¬", "ì´íš¨ì£¼", "ê¹€ì´ìˆ™", "ë°•ìœ ë¯¸", "ì„ì°¬ë™", "ê¹€ìˆœì¢…", "ì•ˆì¬í˜¸", "ê¹€ì„±í‘œ", "ì´ë¯¸ì •", "ê°•ë™í¬", "ë°•ì˜ì‹¬", "ë°•ìŠ¹í¬", "ë°•ì •ì•„", "ì •ìˆ˜ì§„", "ê¹€ìˆœìš”", "ê¹€ë•ìˆœ", "ìë…€1", "ìë…€2", "ì¥ì†Œí¬", "ë°°ì†Œì˜", "ì´íš¨ì¤€", "ë°•ë¯¸í˜„"];
            b2.forEach((n, i) => {
                const isRight = i >= 20;
                const seat = (Math.floor((i % 20) / 2) * 4) + (isRight ? 2 : 0) + (i % 2);
                data.push({ id: `b2-${i}`, name: n, vehicleType: 'ë²„ìŠ¤ 2í˜¸ì°¨', departure: '2/23(ì›”) ì˜¤ì „', return: '2/25(ìˆ˜) ì˜¤ì „', seatPosition: seat, groupId: 'bus2' });
            });

            // ë²„ìŠ¤ 3í˜¸ì°¨ (26ëª…)
            const b3 = ["ì •í•´ì›…", "ì†¡í¬ìƒ", "ì •ì°¬ì‚¼", "ì´ìƒêµ", "ì •í˜•ìš°", "ê³ ì˜ì§„", "ì„œíƒœì›…", "ì´ì„±í—Œ", "ì •ì£¼ì˜", "ì–‘í˜„ì¤€", "ì´ì˜ˆì€", "ì¡°ì€í˜œ", "ì´íš¨ì§„", "ê¹€ê²½ë§Œ", "ë‚˜ë³‘ìƒ", "ì†¡êµ­í•œ", "ì†¡ì •í•œ", "ê¹€ì„±ì˜¤", "ì´ì¤€ì„œ", "ì •í˜„ì§„", "ê³ ì˜ì„œ", "ì–‘ìœ ì§„", "ë°°ë‹¤ë¹ˆ", "ì˜¤íƒœí¬", "ê°•ì„ ë¯¸", "ì´ì„œë¦°"];
            b3.forEach((n, i) => {
                const isRight = i >= 13;
                const seat = (Math.floor((i % 13) / 2) * 4) + (isRight ? 2 : 0) + (i % 2);
                data.push({ id: `b3-${i}`, name: n, vehicleType: 'ë²„ìŠ¤ 3í˜¸ì°¨', departure: '2/23(ì›”) ì˜¤ì „', return: '2/25(ìˆ˜) ì˜¤ì „', seatPosition: seat, groupId: 'bus3' });
            });

            // --- ê°œì¸ì°¨ëŸ‰ ëª…ë‹¨ ë³µêµ¬ (êµ¬ì²´ì  ì‹œê°„ ë°˜ì˜) ---
            const privateGroups = [
                { gid: 'p1', dr: 'ë‚˜ìˆ˜ê¸ˆ', ps: ["ì´ì˜ìš±", "ì´ê²½ì• ", "ì´í˜œë ¹", "ë°•ìœ ë¯¸"], dep: '2/23(ì›”) ì €ë…', ret: '2/24(í™”) ì €ë…', note: 'ë‚˜ìˆ˜ê¸ˆS ì°¨ëŸ‰ | ê·€ê°€ì‹œ ì´í˜œë ¹, ë°•ìœ ë¯¸ ë™ìŠ¹' },
                { gid: 'p2', dr: 'ê³ í™ì„', ps: ["ì´ì² ê·€"], dep: '2/23(ì›”) ì˜¤í›„', ret: '2/24(í™”) ì €ë…', note: 'ê³ í™ì„B ì°¨ëŸ‰' },
                { gid: 'p3', dr: 'ê¹€ìš©í˜„', ps: ["ìœ¤ë¯¸ì„ ", "ì´ì˜ìˆ™", "ì´ì˜ë¡€", "ì–‘ëª…í˜¸", "ë…¸ë¯¸ë…€", "í™ìŠ¹ì£¼"], dep: '2/24(í™”) ìƒˆë²½', ret: '2/24(í™”) ì €ë…', note: 'ê¹€ìš©í˜„B ì°¨ëŸ‰' },
                { gid: 'p4', dr: 'ì´ì¢…í›ˆ', ps: [], dep: '2/23(ì›”) ì €ë…', ret: '2/24(í™”) ì €ë…', note: 'ê°œì¸ ì¶œë°œ (íšŒì‚¬)' },
                { gid: 'p5', dr: 'ì´ì •ë¯¼', ps: [], dep: '2/23(ì›”) ì˜¤ì „', ret: '2/24(í™”) ì €ë…', note: 'ê°œë³„ ì¶œë°œ' },
                { gid: 'p6', dr: 'ê¹€ì–‘í˜„', ps: [], dep: '2/23(ì›”) ì˜¤ì „', ret: '2/23(ì›”) ì €ë…', note: 'ê°œì¸ ì¶œë°œ (íšŒì‚¬)' },
                { gid: 'p7', dr: 'ê¹€ì›…ë²”', ps: [], dep: '2/23(ì›”) ì˜¤ì „', ret: '2/25(ìˆ˜) ì˜¤ì „', note: 'ê°œë³„ ì¶œë°œ' }
            ];

            privateGroups.forEach(g => {
                [g.dr, ...g.ps].forEach(name => {
                    data.push({
                        id: `p-${name}`, name, vehicleType: 'ê°œì¸ì°¨ëŸ‰', groupId: g.gid, 
                        isDriver: name === g.dr, departure: g.dep, return: g.ret, details: g.note
                    });
                });
            });

            // --- êµíšŒì°¨ëŸ‰ ëª…ë‹¨ ë³µêµ¬ (ìš”ì²­í•˜ì‹  êµ¬ì²´ì  ì¶œë°œì‹œê°„ ë°˜ì˜) ---
            const churchGroups = [
                { gid: 'c1', type: 'ìŠ¤íƒ€ë¦¬ì•„ A', dep: '2/23(ì›”) ì˜¤ì „ 07:00', ret: '2/23(ì›”) ì €ë…', members: ["ê¹€ì„ê¶Œ", "ê¹€ì¬ì¤‘", "ìœ í˜„", "ê¹€ëŒ€ì¤‘", "ê¹€ë™ë§Œ", "ìµœì¬ì˜", "ë¬¸ë³‘ìš©"] },
                { gid: 'c2', type: 'ìŠ¤íƒ€ë ‰ìŠ¤ B', dep: '2/23(ì›”) ì €ë… 19:40', ret: '2/24(í™”) ì €ë…', members: ["ê°•ì§€ìŠ¹", "ì†í˜•í™˜", "ìµœì˜í˜„", "í™©ê·œì—°", "ë…¸ìš°ì„", "ì„œë¶€ì„", "ë¬¸ì„±í˜"] },
                { gid: 'c3', type: 'ìŠ¤íƒ€ë¦¬ì•„ C', dep: '2/24(í™”) ì €ë… 19:30', ret: '2/25(ìˆ˜) ì˜¤ì „', members: ["ì¥ì„¸í˜", "ê¹€ìƒì¤€", "ê¹€ìŠ¹ì™„", "ê¹€ìš©ì„±", "ì°¨ë™ì² ", "ê¹€ìš©ê±¸"] }
            ];

            churchGroups.forEach(g => {
                g.members.forEach(name => {
                    data.push({
                        id: `c-${name}`, name, vehicleType: 'êµíšŒì°¨ëŸ‰', groupId: g.gid,
                        isDriver: false, departure: g.dep, return: g.ret, details: `${g.type} ì´ìš©`
                    });
                });
            });

            return data;
        };

        const DeleteConfirm = ({ name, onConfirm, onCancel }) => (
            <div className="fixed inset-0 z-[300] flex items-center justify-center p-6 bg-slate-900/60 backdrop-blur-sm" onClick={onCancel}>
                <div className="bg-white w-full max-w-xs rounded-3xl overflow-hidden shadow-2xl animate-pop" onClick={e => e.stopPropagation()}>
                    <div className="p-8 text-center">
                        <div className="w-16 h-16 bg-red-100 text-red-600 rounded-full flex items-center justify-center mx-auto mb-4 text-2xl">âš ï¸</div>
                        <h3 className="text-xl font-black mb-2">ì •ë§ ì‚­ì œí• ê¹Œìš”?</h3>
                        <p className="text-slate-500 text-sm font-medium leading-relaxed">[{name}] ë‹˜ì„ ëª…ë‹¨ì—ì„œ ì œì™¸í•©ë‹ˆë‹¤.</p>
                    </div>
                    <div className="flex border-t border-slate-100">
                        <button onClick={onCancel} className="flex-1 py-4 font-bold text-slate-400">ì·¨ì†Œ</button>
                        <button onClick={onConfirm} className="flex-1 py-4 font-black text-red-600 border-l border-slate-100">ì‚­ì œ</button>
                    </div>
                </div>
            </div>
        );

        const App = () => {
            const [data, setData] = useState([]);
            const [isShareMode, setIsShareMode] = useState(false);
            const [searchTerm, setSearchTerm] = useState('');
            const [selectedItem, setSelectedItem] = useState(null);
            const [confirmId, setConfirmId] = useState(null);
            const [draggedId, setDraggedId] = useState(null);

            const [form, setForm] = useState({ name: '', vehicle: 'ë²„ìŠ¤ 1í˜¸ì°¨', dep: '2/23(ì›”) ì˜¤ì „', ret: '2/25(ìˆ˜) ì˜¤ì „', memo: '' });

            useEffect(() => {
                const saved = localStorage.getItem('retreat_2026_full_v4');
                setData(saved ? JSON.parse(saved) : generateInitialData());
            }, []);

            useEffect(() => {
                if (data.length > 0) localStorage.setItem('retreat_2026_full_v4', JSON.stringify(data));
            }, [data]);

            const stats = useMemo(() => ({
                b1: data.filter(p => p.vehicleType === 'ë²„ìŠ¤ 1í˜¸ì°¨').length,
                b2: data.filter(p => p.vehicleType === 'ë²„ìŠ¤ 2í˜¸ì°¨').length,
                b3: data.filter(p => p.vehicleType === 'ë²„ìŠ¤ 3í˜¸ì°¨').length,
                priv: data.filter(p => p.vehicleType === 'ê°œì¸ì°¨ëŸ‰').length,
                church: data.filter(p => p.vehicleType === 'êµíšŒì°¨ëŸ‰').length,
            }), [data]);

            // ê²€ìƒ‰ì–´ì— ë”°ë¥¸ í•„í„°ë§ëœ ë°ì´í„°
            const searchResults = useMemo(() => {
                if (!searchTerm.trim()) return [];
                return data.filter(p => p.name.includes(searchTerm.trim()));
            }, [data, searchTerm]);

            const handleAdd = (e) => {
                e.preventDefault();
                if (!form.name.trim()) return;
                const busData = data.filter(p => p.vehicleType === form.vehicle);
                let seat = 0;
                const occupied = new Set(busData.map(p => p.seatPosition));
                while (occupied.has(seat)) seat++;

                const newItem = {
                    id: `new-${Date.now()}`,
                    name: form.name.trim(),
                    vehicleType: form.vehicle,
                    departure: form.dep,
                    return: form.ret,
                    details: form.memo,
                    seatPosition: seat,
                    groupId: `group-${Date.now()}`
                };
                setData([newItem, ...data]);
                setForm({ ...form, name: '', memo: '' });
            };

            const handleDrop = (e, vehicle, seat) => {
                e.preventDefault();
                const sid = e.dataTransfer.getData('sid');
                if (!sid) return;
                setData(prev => {
                    const next = [...prev];
                    const sIdx = next.findIndex(p => p.id === sid);
                    const tIdx = next.findIndex(p => p.vehicleType === vehicle && p.seatPosition === seat);
                    const sItem = next[sIdx];
                    if (tIdx !== -1) {
                        const tItem = next[tIdx];
                        next[sIdx] = { ...sItem, vehicleType: vehicle, seatPosition: seat };
                        next[tIdx] = { ...tItem, vehicleType: sItem.vehicleType, seatPosition: sItem.seatPosition };
                    } else {
                        next[sIdx] = { ...sItem, vehicleType: vehicle, seatPosition: seat };
                    }
                    return next;
                });
                setDraggedId(null);
            };

            const renderBus = (type) => {
                const members = data.filter(p => p.vehicleType === type);
                const capacity = type === 'ë²„ìŠ¤ 2í˜¸ì°¨' ? 47 : 45;
                const remaining = capacity - members.length;

                return (
                    <div className="bus-container animate-pop">
                        <div className="bus-head">
                            <div className="w-10 h-10 bg-slate-200 rounded-full flex items-center justify-center text-xs font-black">ìš´ì „</div>
                            <div className="w-10 h-10 border-2 border-slate-200 rounded-lg flex items-center justify-center text-[10px] font-bold text-slate-300">ì…êµ¬</div>
                        </div>
                        <h4 className="text-center font-black text-xl mb-6 text-slate-800">{type}</h4>
                        <div className="flex justify-center gap-1">
                            <div className="grid grid-cols-2 gap-1 flex-1">
                                {Array.from({ length: 12 }).map((_, r) => [0, 1].map(c => {
                                    const seatIdx = r * 4 + c;
                                    const p = members.find(m => m.seatPosition === seatIdx);
                                    const isMatch = searchTerm.trim() !== '' && p?.name.includes(searchTerm.trim());
                                    return (
                                        <div key={seatIdx} 
                                            onDragOver={e => e.preventDefault()} 
                                            onDrop={e => handleDrop(e, type, seatIdx)}
                                            className={`seat ${p ? 'seat-occupied' : 'seat-empty'} ${draggedId === p?.id ? 'opacity-20' : ''} ${isMatch ? 'seat-highlight' : ''}`}
                                            draggable={!isShareMode && !!p}
                                            onDragStart={e => { setDraggedId(p.id); e.dataTransfer.setData('sid', p.id); }}
                                            onClick={() => p && setSelectedItem(p)}
                                        >{p?.name}</div>
                                    );
                                }))}
                            </div>
                            <div className="aisle"></div>
                            <div className="grid grid-cols-2 gap-1 flex-1">
                                {Array.from({ length: 12 }).map((_, r) => [2, 3].map(c => {
                                    const seatIdx = r * 4 + c;
                                    const p = members.find(m => m.seatPosition === seatIdx);
                                    const isMatch = searchTerm.trim() !== '' && p?.name.includes(searchTerm.trim());
                                    return (
                                        <div key={seatIdx} 
                                            onDragOver={e => e.preventDefault()} 
                                            onDrop={e => handleDrop(e, type, seatIdx)}
                                            className={`seat ${p ? 'seat-occupied' : 'seat-empty'} ${draggedId === p?.id ? 'opacity-20' : ''} ${isMatch ? 'seat-highlight' : ''}`}
                                            draggable={!isShareMode && !!p}
                                            onDragStart={e => { setDraggedId(p.id); e.dataTransfer.setData('sid', p.id); }}
                                            onClick={() => p && setSelectedItem(p)}
                                        >{p?.name}</div>
                                    );
                                }))}
                            </div>
                        </div>
                        <div className="mt-6 pt-4 border-t-2 border-slate-50 flex justify-center items-center gap-2">
                            <span className="text-[10px] font-black text-slate-400 uppercase tracking-widest">Remaining</span>
                            <span className="bg-blue-600 text-white px-3 py-1 rounded-full text-xs font-black shadow-lg shadow-blue-200">{remaining}ì„</span>
                        </div>
                    </div>
                );
            };

            const otherPassengers = useMemo(() => {
                if (!selectedItem || !selectedItem.groupId) return [];
                return data.filter(p => p.groupId === selectedItem.groupId && p.id !== selectedItem.id);
            }, [selectedItem, data]);

            return (
                <div className="max-w-6xl mx-auto px-4 py-8 pb-32">
                    <header className="flex justify-between items-center mb-10">
                        <div>
                            <h1 className="text-3xl font-black text-slate-900 tracking-tighter">2026 ì „ë„ì¸ ìˆ˜ë ¨íšŒ <span className="text-blue-600">ì°¨ëŸ‰ìš´ì˜</span></h1>
                            <p className="text-xs font-bold text-slate-400 uppercase tracking-widest">Evangelist Retreat Dashboard</p>
                        </div>
                        <button onClick={() => setIsShareMode(!isShareMode)} className={`px-6 py-3 rounded-2xl font-black text-xs shadow-xl transition-all active:scale-95 ${isShareMode ? 'bg-red-500 text-white' : 'bg-slate-900 text-white'}`}>
                            {isShareMode ? 'ğŸ”“ ê´€ë¦¬ ëª¨ë“œ' : 'ğŸ”’ ê³µìœ  ëª¨ë“œ'}
                        </button>
                    </header>

                    {!isShareMode && (
                        <section className="bg-white p-8 rounded-[40px] shadow-2xl border border-slate-100 mb-12 animate-pop">
                            <h3 className="text-sm font-black text-slate-400 uppercase mb-6 flex items-center gap-2">
                                <span className="w-2 h-2 bg-blue-500 rounded-full"></span> ì‹ ê·œ ë°°ì • ë“±ë¡
                            </h3>
                            <form onSubmit={handleAdd} className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div className="space-y-4">
                                    <input type="text" placeholder="ì„±í•¨" value={form.name} onChange={e => setForm({...form, name: e.target.value})} className="w-full h-14 px-6 bg-slate-50 border-2 border-slate-100 rounded-2xl font-bold outline-none focus:border-blue-500 transition-colors" />
                                    <select value={form.vehicle} onChange={e => setForm({...form, vehicle: e.target.value})} className="w-full h-14 px-6 bg-slate-50 border-2 border-slate-100 rounded-2xl font-bold outline-none">
                                        {['ë²„ìŠ¤ 1í˜¸ì°¨', 'ë²„ìŠ¤ 2í˜¸ì°¨', 'ë²„ìŠ¤ 3í˜¸ì°¨', 'ê°œì¸ì°¨ëŸ‰', 'êµíšŒì°¨ëŸ‰'].map(v => <option key={v}>{v}</option>)}
                                    </select>
                                </div>
                                <div className="space-y-4">
                                    <div className="flex gap-2">
                                        <select value={form.dep} onChange={e => setForm({...form, dep: e.target.value})} className="flex-1 h-14 px-4 bg-slate-50 border-2 border-slate-100 rounded-2xl font-bold text-sm">
                                            {TIME_OPTIONS.map(t => <option key={t}>{t}</option>)}
                                        </select>
                                        <select value={form.ret} onChange={e => setForm({...form, ret: e.target.value})} className="flex-1 h-14 px-4 bg-slate-50 border-2 border-slate-100 rounded-2xl font-bold text-sm">
                                            {TIME_OPTIONS.map(t => <option key={t}>{t}</option>)}
                                        </select>
                                    </div>
                                    <input type="text" placeholder="ë©”ëª¨" value={form.memo} onChange={e => setForm({...form, memo: e.target.value})} className="w-full h-14 px-6 bg-slate-50 border-2 border-slate-100 rounded-2xl font-bold outline-none" />
                                </div>
                                <button className="md:col-span-2 h-16 bg-blue-600 text-white rounded-2xl font-black text-lg shadow-xl active:scale-[0.98] transition-all">ë°°ì • ì™„ë£Œ</button>
                            </form>
                        </section>
                    )}

                    <div className="relative mb-12 group">
                        <input type="text" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì—¬ ìœ„ì¹˜ë¥¼ í™•ì¸í•˜ì„¸ìš”..." value={searchTerm} onChange={e => setSearchTerm(e.target.value)} className="w-full h-20 bg-white border-4 border-slate-100 rounded-full px-16 font-black text-xl shadow-2xl outline-none focus:border-blue-500 transition-all" />
                        <div className="absolute left-6 top-1/2 -translate-y-1/2 text-2xl opacity-20">ğŸ”</div>
                    </div>

                    {/* ê²€ìƒ‰ ê²°ê³¼ ìš”ì•½ (ì‚¬ìš©ì í¸ì˜ì„± ì¦ëŒ€) */}
                    {searchTerm.trim() !== '' && (
                        <div className="mb-12 bg-blue-50 border-2 border-blue-100 p-6 rounded-[32px] animate-pop">
                            <h4 className="text-sm font-black text-blue-400 uppercase mb-4">'{searchTerm}' ê²€ìƒ‰ ê²°ê³¼ ({searchResults.length}ê±´)</h4>
                            <div className="flex flex-wrap gap-2">
                                {searchResults.map(p => (
                                    <button key={p.id} onClick={() => setSelectedItem(p)} className="bg-white border-2 border-blue-200 px-4 py-2 rounded-full text-sm font-black text-blue-600 hover:bg-blue-600 hover:text-white transition-all shadow-sm">
                                        {p.name} ({p.vehicleType})
                                    </button>
                                ))}
                                {searchResults.length === 0 && <p className="text-slate-400 font-bold text-sm">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>}
                            </div>
                        </div>
                    )}

                    <div className="flex justify-around mb-16 text-center">
                        <div><p className="text-[10px] font-black text-slate-300">ë²„ìŠ¤ í•©ê³„</p><p className="text-2xl font-black">{stats.b1+stats.b2+stats.b3}</p></div>
                        <div><p className="text-[10px] font-black text-slate-300">ê°œì¸ì°¨ëŸ‰</p><p className="text-2xl font-black text-emerald-500">{stats.priv}</p></div>
                        <div><p className="text-[10px] font-black text-slate-300">êµíšŒì°¨ëŸ‰</p><p className="text-2xl font-black text-amber-500">{stats.church}</p></div>
                    </div>

                    <section className="mb-20">
                        <h2 className="text-2xl font-black text-slate-800 mb-10 border-l-8 border-blue-500 pl-4">ğŸšŒ ë²„ìŠ¤ íƒ‘ìŠ¹ ì¢Œì„ë„</h2>
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
                            {renderBus('ë²„ìŠ¤ 1í˜¸ì°¨')}{renderBus('ë²„ìŠ¤ 2í˜¸ì°¨')}{renderBus('ë²„ìŠ¤ 3í˜¸ì°¨')}
                        </div>
                    </section>

                    <section>
                        <h2 className="text-2xl font-black text-slate-800 mb-10 border-l-8 border-slate-200 pl-4">ğŸš— ê¸°íƒ€ ì°¨ëŸ‰ ë°°ì • í˜„í™©</h2>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                            {['ê°œì¸ì°¨ëŸ‰', 'êµíšŒì°¨ëŸ‰'].map(cat => {
                                // ê²€ìƒ‰ ê¸°ëŠ¥ì´ ëª¨ë“  ì°¨ëŸ‰ ë¦¬ìŠ¤íŠ¸ì— ì¦‰ì‹œ ë°˜ì˜ë˜ë„ë¡ í•„í„°ë§ ë¡œì§ ê°•í™”
                                const list = data.filter(p => p.vehicleType === cat && (searchTerm.trim() === '' || p.name.includes(searchTerm.trim())));
                                if (list.length === 0 && searchTerm.trim() === '') return null;
                                return (
                                    <div key={cat} className="mb-8">
                                        <h3 className={`text-lg font-black mb-6 px-4 py-2 inline-block rounded-xl ${cat === 'ê°œì¸ì°¨ëŸ‰' ? 'bg-emerald-100 text-emerald-700' : 'bg-amber-100 text-amber-700'}`}>{cat}</h3>
                                        <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                            {list.map(p => (
                                                <div key={p.id} className="bg-white p-6 rounded-[32px] border-2 border-slate-50 shadow-sm hover:shadow-xl transition-all cursor-pointer group" onClick={() => setSelectedItem(p)}>
                                                    <div className="flex justify-between items-start">
                                                        <div>
                                                            <div className="flex items-center gap-2 mb-2">
                                                                <span className="text-xl font-black text-slate-800">{p.name}</span>
                                                                {p.isDriver && <span className="bg-red-500 text-white text-[8px] px-1.5 py-0.5 rounded-md font-black">DRIVER</span>}
                                                            </div>
                                                            <div className="flex flex-col gap-1">
                                                                <span className="text-[11px] font-black text-blue-600 bg-blue-50 px-2 py-0.5 rounded-lg w-fit">ì¶œë°œ: {p.departure}</span>
                                                                <p className="text-[10px] font-bold text-slate-400 line-clamp-1">{p.details}</p>
                                                            </div>
                                                        </div>
                                                        {!isShareMode && <button onClick={e => { e.stopPropagation(); setConfirmId(p.id); }} className="text-slate-200 hover:text-red-500 text-xl transition-colors">âœ•</button>}
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    </section>

                    {confirmId && <DeleteConfirm name={data.find(p => p.id === confirmId)?.name} onConfirm={() => { setData(d => d.filter(p => p.id !== confirmId)); setConfirmId(null); }} onCancel={() => setConfirmId(null)} />}
                    
                    {selectedItem && (
                        <div className="fixed inset-0 z-[150] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-md" onClick={() => setSelectedItem(null)}>
                            <div className="bg-white w-full max-w-lg rounded-[40px] overflow-hidden shadow-2xl animate-pop" onClick={e => e.stopPropagation()}>
                                <div className={`p-10 ${selectedItem.vehicleType === 'ê°œì¸ì°¨ëŸ‰' ? 'bg-emerald-500' : selectedItem.vehicleType === 'êµíšŒì°¨ëŸ‰' ? 'bg-amber-500' : 'bg-blue-600'} text-white relative`}>
                                    <button onClick={() => setSelectedItem(null)} className="absolute top-6 right-6 w-10 h-10 flex items-center justify-center bg-black/10 rounded-full text-xl font-black">âœ•</button>
                                    <h4 className="text-[10px] font-black uppercase tracking-widest opacity-60 mb-2">{selectedItem.vehicleType}</h4>
                                    <h2 className="text-5xl font-black">{selectedItem.name}</h2>
                                </div>
                                <div className="p-10 space-y-8 max-h-[60vh] overflow-y-auto">
                                    <div className="grid grid-cols-2 gap-6">
                                        <div><p className="text-[10px] font-black text-slate-300 uppercase mb-2">Departure</p><p className="text-lg font-black text-slate-800">{selectedItem.departure}</p></div>
                                        <div><p className="text-[10px] font-black text-slate-300 uppercase mb-2">Return</p><p className="text-lg font-black text-slate-800">{selectedItem.return}</p></div>
                                    </div>
                                    
                                    <div>
                                        <p className="text-[10px] font-black text-slate-300 uppercase mb-2">Vehicle Info</p>
                                        <p className="text-xl font-bold text-slate-600 leading-relaxed">{selectedItem.details || 'ì¶”ê°€ ë©”ëª¨ê°€ ì—†ìŠµë‹ˆë‹¤.'}</p>
                                    </div>

                                    {otherPassengers.length > 0 && (
                                        <div className="pt-6 border-t border-slate-100">
                                            <p className="text-[10px] font-black text-slate-300 uppercase mb-4">ë™ìŠ¹ì ({otherPassengers.length}ëª…)</p>
                                            <div className="flex flex-wrap gap-2">
                                                {otherPassengers.map(op => (
                                                    <span key={op.id} className="bg-slate-50 border border-slate-100 px-4 py-2 rounded-full text-sm font-black text-slate-700">{op.name}</span>
                                                ))}
                                            </div>
                                        </div>
                                    )}

                                    <button onClick={() => setSelectedItem(null)} className="w-full py-5 bg-slate-900 text-white rounded-2xl font-black active:scale-95 transition-all">í™•ì¸</button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>