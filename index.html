<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>2026 Ï†ÑÎèÑÏù∏ ÏàòÎ†®Ìöå Ï∞®ÎüâÏö¥ÏòÅ</title>
    
    <!-- CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>

    <style>
        body { 
            font-family: 'Pretendard', sans-serif;
            -webkit-tap-highlight-color: transparent;
            letter-spacing: -0.02em;
            background-color: #f1f5f9;
            word-break: keep-all;
        }
        .safe-area-bottom { padding-bottom: env(safe-area-inset-bottom); }
        
        .bus-container {
            background: #ffffff;
            border: 2px solid #e2e8f0;
            border-radius: 24px;
            padding: 12px;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05);
        }
        
        .seat {
            width: 100%;
            height: 32px;
            border-radius: 6px;
            font-size: 10px;
            font-weight: 800;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        .seat-occupied {
            background-color: #FFD700;
            color: #000;
            border: 1.5px solid #000;
        }
        .seat-highlight {
            background-color: #3b82f6 !important;
            color: white !important;
            border-color: #000 !important;
            transform: scale(1.1);
            z-index: 10;
        }
        .seat-empty { background-color: #f8fafc; border: 1px solid #e2e8f0; color: transparent; }
        .aisle { width: 10px; }

        .church-card {
            background: white;
            border: 1.5px solid #e2e8f0;
            border-radius: 16px;
            padding: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
        }
        
        .info-table { width: 100%; font-size: 11px; }
        .info-table th { padding: 8px; background: #f8fafc; color: #64748b; font-weight: 800; text-align: left; border-bottom: 2px solid #e2e8f0; }
        .info-table td { padding: 10px 8px; border-bottom: 1px solid #f1f5f9; background: white; }

        .sticky-header { position: sticky; top: 0; z-index: 40; background: rgba(241, 245, 249, 0.95); backdrop-filter: blur(8px); }
        .animate-pop { animation: pop 0.25s ease-out; }
        @keyframes pop { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    </style>
</head>
<body class="text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect, useRef } = React;

        const TIME_OPTIONS = [
            '2Ïõî 23Ïùº Ïò§Ï†ÑÏ∂úÎ∞ú', '2Ïõî 23Ïùº Ïò§ÌõÑÏ∂úÎ∞ú', '2Ïõî 23Ïùº Ï†ÄÎÖÅÏ∂úÎ∞ú',
            '2Ïõî 24Ïùº ÏÉàÎ≤ΩÏ∂úÎ∞ú', '2Ïõî 24Ïùº Ïò§Ï†ÑÏ∂úÎ∞ú', '2Ïõî 24Ïùº Ïò§ÌõÑÏ∂úÎ∞ú', '2Ïõî 24Ïùº Ï†ÄÎÖÅÏ∂úÎ∞ú',
            '2Ïõî 23Ïùº Ï†ÄÎÖÅÍ∑ÄÍ∞Ä', '2Ïõî 24Ïùº Ï†ÄÎÖÅÍ∑ÄÍ∞Ä', '2Ïõî 25Ïùº Ïò§Ï†ÑÍ∑ÄÍ∞Ä',
            '07:00', '19:30', '19:40'
        ];

        const generateInitialData = () => {
            const data = [];
            const addSeat = (vehicle, row, col, name) => {
                if (!name) return;
                data.push({
                    id: `${vehicle}-${row}-${col}-${name}-${Math.random()}`,
                    name,
                    vehicleType: vehicle,
                    departure: '2Ïõî 23Ïùº Ïò§Ï†ÑÏ∂úÎ∞ú',
                    return: '2Ïõî 25Ïùº Ïò§Ï†ÑÍ∑ÄÍ∞Ä',
                    seatPosition: row * 4 + col,
                    groupId: vehicle === 'ÏÑ†Î∞úÎåÄ' ? 'bus1' : vehicle === '2Ìò∏Ï∞®' ? 'bus2' : 'bus3'
                });
            };

            // ÏÑ†Î∞úÎåÄ Ï¢åÏÑùÌëú
            const b1 = [
                ["Î∞ïÎØ∏Ïàú", "Î∞ïÏàú", "Ïã†Ìö®ÏÑ±", "Î∞ïÏòÅÎØ∏"],
                ["Î∞ïÏäπÌù¨", "Ïú§ÎØ∏Ïï†", "Í≥µÌòÑÏï†", "ÎÖ∏ÎØºÏàô"],
                ["Ìô©Ïû¨Ìñ•", "ÌóàÍ≤ΩÏã¨", "ÏµúÏ†ïÏàô", "ÍπÄÏú§Ìù¨"],
                ["ÍπÄÏù∏Ïàô", "Ï°∞Í¥ëÏàú", "Î∞±Ï¢ÖÎØ∏", "ÍπÄÏó∞Ìôî"],
                ["ÍπÄÏï†Ïàô", "Ïù¥Î™ÖÏàô", "Í∞ïÎèôÌù¨", "Î¨∏Ï†ïÏò•"],
                ["Î∞ïÎ≥µÏàú", "Î¨∏Ï∂òÏûê", "Ïù¥Î¥âÏûÑ", "ÍπÄÏàôÏòÅ"],
                ["ÍπÄÏï†ÎûÄ", "ÏïàÏÉÅÏïÑ", "Ïù¥ÎØ∏Í≤Ω", "Ïû•ÏÜåÌù¨"],
                ["Ïù¥ÏùÄÏûê", "ÌïúÏùÄÍ≤Ω", "Ïú§ÌïòÏßÑ", "Ïú§ÌïòÏ§Ä"],
                ["Ìô©Ïó∞Ïàô"]
            ];
            b1.forEach((row, rIdx) => row.forEach((name, cIdx) => addSeat('ÏÑ†Î∞úÎåÄ', rIdx, cIdx, name)));

            // 2Ìò∏Ï∞® Ï¢åÏÑùÌëú
            const b2 = [
                ["Ïú§Ìï¥Í∂å", "Î∞∞ÌòÑÍ∏∞", "ÏñëÌöåÏàú", "Ïù¥ÏñëÌò∏"],
                ["ÏÜ°Í∏∞Ìò∏", "ÏÑúÏòÅÏßÑ", "Ïù¥Ï∂òÏÑ†", "ÍπÄÏÑ±Ïò•"],
                ["Ï†ïÎèôÍ∑ú", "Ïù¥Ï†ïÌù¨", "ÏûÑÏ∞¨Îèô", "ÍπÄÏàúÏ¢Ö"],
                ["Î∞ïÏòÅÏûê", "ÍπÄÏßÑÌù¨", "ÏïàÏû¨Ìò∏", "ÍπÄÏÑ±Ìëú"],
                ["ÍπÄÏàôÌù¨", "Ïù¥ÌòúÎ†π", "ÏµúÏùÄÌù¨", "Ïù¥ÎØ∏Ïàô"],
                ["ÍπÄÎã§Ïö¥", "Ïù¥ÏàúÎ°Ä", "ÏñëÌù¨Í≤Ω", "Í∞ïÏ†ïÏù∏"],
                ["ÏñëÎûÄÌù¨", "Ï†ïÏòÅÎûÄ", "ÍπÄÏÜåÏòÅ", "ÏûêÎÖÄ1"],
                ["ÎÖ∏Ïó∞ÎØ∏", "Ïù¥ÏàúÌù¨", "Ï†ïÏàòÏßÑ", "Ïù¥ÎØ∏Ï†ï"],
                ["ÍπÄÏï†ÎûÄ", "Ïù¥Í∞ïÏûê(Í∑ÄÍ∞Ä)", "ÍπÄÎçïÏàú", "Î∞ïÏòÅÏã¨"],
                ["ÏïàÏú§ÎØ∏", "ÏûêÎÖÄ1", "ÍπÄÏù¥Ïàô", "Î∞ïÏ†ïÏïÑ"],
                ["Ïù¥Ìö®Ïû¨", "Ïù¥Ìö®Ï£º"],
                ["Ïù¥Ìö®Ï§Ä", null, "Î∞ïÎØ∏ÌòÑ", "ÍπÄÏàúÏöî"]
            ];
            b2.forEach((row, rIdx) => row.forEach((name, cIdx) => addSeat('2Ìò∏Ï∞®', rIdx, cIdx, name)));

            // 3Ìò∏Ï∞® Ï¢åÏÑùÌëú
            const b3 = [
                ["Ï†ïÌï¥ÏõÖ", "ÏÜ°Ìù¨ÏÉÅ", "ÍπÄÍ≤ΩÎßå", "ÎÇòÎ≥ëÏÉÅ"],
                ["Ï†ïÏ∞¨ÏÇº", "Ïù¥ÏÉÅÍµê", "ÏÜçÍµ≠Ìïú", "ÏÜ°Ï†ïÌïú"],
                ["Ï†ïÌòïÏö∞", "Í≥†ÏòÅÏßÑ", "ÍπÄÏÑ±Ïò§"],
                ["ÏÑúÌÉúÏõÖ", "Ïù¥ÏÑ±Ìóå", "Ïù¥Ï§ÄÏÑú", "Ï†ïÌòÑÏßÑ"],
                ["Ï†ïÏ£ºÏòÅ", "ÏñëÌòÑÏ§Ä", "Í≥†ÏòÅÏÑú", "ÏñëÏú†ÏßÑ"],
                ["Ïù¥ÏòàÏùÄ", "Ï°∞ÏùÄÌòúB", "Î∞∞Îã§Îπà", "Ïò§ÌÉúÌù¨"],
                ["Ïù¥Ìö®ÏßÑ", null, "Í∞ïÏÑ†ÎØ∏", "Ïù¥ÏÑúÎ¶∞"],
                ["Î∞∞ÏÜåÏòÅ", "Î∞ïÏú†ÎØ∏(Ï∂úÎ∞ú)"]
            ];
            b3.forEach((row, rIdx) => row.forEach((name, cIdx) => addSeat('3Ìò∏Ï∞®', rIdx, cIdx, name)));

            // Í∞úÏù∏Ï∞®Îüâ Î™ÖÎã® (Ïù¥ÎØ∏ÏßÄ 2 ÎÇ†Ïßú ÌòïÏãù Î∞òÏòÅ)
            const privateCars = [
                { gid: 'p1', dr: 'ÎÇòÏàòÍ∏à', ps: ["Ïù¥ÏòÅÏö±", "Ïù¥Í≤ΩÏï†", "Ïù¥Í∞ïÏûê"], dep: '2Ïõî 23Ïùº Ï†ÄÎÖÅÏ∂úÎ∞ú', ret: '2Ïõî 24Ïùº Ï†ÄÎÖÅÍ∑ÄÍ∞Ä', note: 'ÎÇòÏàòÍ∏àS (Í∑ÄÍ∞Ä: Ïù¥ÌòúÎ†π, Î∞ïÏú†ÎØ∏)' },
                { gid: 'p2', dr: 'Í≥†ÌôçÏÑù', ps: ["Ïù¥Ï≤†Í∑Ä", "ÏñëÎ™ÖÌò∏"], dep: '2Ïõî 23Ïùº Ïò§ÌõÑÏ∂úÎ∞ú', ret: '2Ïõî 24Ïùº Ï†ÄÎÖÅÍ∑ÄÍ∞Ä', note: 'Í≥†ÌôçÏÑùB Í∞úÏù∏Ï∞®Îüâ' },
                { gid: 'p3', dr: 'ÍπÄÏö©ÌòÑ', ps: ["Ïú§ÎØ∏ÏÑ†", "Ïù¥ÏòÅÏàô", "Ïù¥ÏòÅÎ°Ä", "Î™ÖÏùÄÏ†ï", "ÎÖ∏ÎØ∏ÎÖÄ", "ÌôçÏäπÏ£º"], dep: '2Ïõî 24Ïùº ÏÉàÎ≤ΩÏ∂úÎ∞ú', ret: '2Ïõî 24Ïùº Ï†ÄÎÖÅÍ∑ÄÍ∞Ä', note: 'ÍπÄÏö©ÌòÑB Í∞úÏù∏Ï∞®Îüâ' },
                { gid: 'p4', dr: 'Ïù¥Ï¢ÖÌõà', ps: [], dep: '2Ïõî 23Ïùº Ï†ÄÎÖÅÏ∂úÎ∞ú', ret: '2Ïõî 24Ïùº Ï†ÄÎÖÅÍ∑ÄÍ∞Ä', note: 'Ïù¥Ï¢ÖÌõàB (ÌöåÏÇ¨ÏóêÏÑú Í∞úÏù∏Ï∂úÎ∞ú)' },
                { gid: 'p5', dr: 'Ïù¥Ï†ïÎØº', ps: [], dep: '2Ïõî 23Ïùº Ïò§Ï†ÑÏ∂úÎ∞ú', ret: '2Ïõî 24Ïùº Ï†ÄÎÖÅÍ∑ÄÍ∞Ä', note: 'Ïù¥Ï†ïÎØºB (Í∞úÎ≥Ñ Ï∂úÎ∞ú)' },
                { gid: 'p6', dr: 'ÍπÄÏñëÌòÑ', ps: [], dep: '2Ïõî 23Ïùº Ïò§Ï†ÑÏ∂úÎ∞ú', ret: '2Ïõî 23Ïùº Ï†ÄÎÖÅÍ∑ÄÍ∞Ä', note: 'ÍπÄÏñëÌòÑB (ÌöåÏÇ¨ÏóêÏÑú Í∞úÏù∏Ï∂úÎ∞ú)' },
                { gid: 'p7', dr: 'ÍπÄÏõÖÎ≤î', ps: [], dep: '2Ïõî 23, 25Ïùº', ret: '-', note: 'ÍπÄÏõÖÎ≤îB (Í∞úÎ≥Ñ Ï∂úÎ∞ú)' }
            ];
            privateCars.forEach(g => {
                [g.dr, ...g.ps].forEach(name => {
                    if(!name) return;
                    data.push({
                        id: `p-${name}-${Math.random()}`, name, vehicleType: 'Í∞úÏù∏Ï∞®Îüâ', groupId: g.gid, isDriver: name === g.dr, departure: g.dep, return: g.ret, details: g.note
                    });
                });
            });

            // ÍµêÌöåÏ∞®Îüâ Î™ÖÎã®
            const churchCars = [
                { gid: 'c1', type: 'Ïä§ÌÉÄÎ¶¨ÏïÑ A', dep: 'Ïò§Ï†Ñ 07:00', ret: 'Ï†ÄÎÖÅ 19:40', members: ["ÍπÄÏÑùÍ∂å", "ÍπÄÏû¨Ï§ë", "Ïú†ÌòÑ", "ÍπÄÎåÄÏ§ë", "ÍπÄÎèôÎßå", "ÏµúÏû¨ÏòÅ", "Î¨∏Î≥ëÏö©"] },
                { gid: 'c2', type: 'Ïä§ÌÉÄÎ†âÏä§ B', dep: '19:40', ret: 'Ï†ÄÎÖÅ 20:00', members: ["Í∞ïÏßÄÏäπ", "ÏÜêÌòïÌôò", "ÏµúÏòÅÌòÑ", "Ìô©Í∑úÏó∞", "ÎÖ∏Ïö∞ÏÑù", "ÏÑúÎ∂ÄÏÑù", "Î¨∏ÏÑ±ÌòÅ"] },
                { gid: 'c3', type: 'Ïä§ÌÉÄÎ¶¨ÏïÑ C', dep: '19:30', ret: 'Ïò§Ï†Ñ 09:00', members: ["Ïû•ÏÑ∏ÌòÅ", "ÍπÄÏÉÅÏ§Ä", "ÍπÄÏäπÏôÑ", "ÍπÄÏö©ÏÑ±", "Ï∞®ÎèôÏ≤†", "ÍπÄÏö©Í±∏"] }
            ];
            churchCars.forEach(g => g.members.forEach(name => {
                data.push({ 
                    id: `c-${name}-${Math.random()}`, name, vehicleType: 'ÍµêÌöåÏ∞®Îüâ', groupId: g.gid, isDriver: false, departure: g.dep, return: g.ret, details: g.type 
                });
            }));

            return data;
        };

        const App = () => {
            const [data, setData] = useState([]);
            const [isAdmin, setIsAdmin] = useState(false);
            const [searchTerm, setSearchTerm] = useState('');
            const [selectedItem, setSelectedItem] = useState(null);
            const [confirmId, setConfirmId] = useState(null);
            const [form, setForm] = useState({ name: '', vehicle: 'ÏÑ†Î∞úÎåÄ', dep: TIME_OPTIONS[0], ret: TIME_OPTIONS[9], memo: '' });

            useEffect(() => {
                const saved = localStorage.getItem('retreat_v21_final');
                setData(saved ? JSON.parse(saved) : generateInitialData());
            }, []);

            useEffect(() => {
                if (data.length > 0) localStorage.setItem('retreat_v21_final', JSON.stringify(data));
            }, [data]);

            const handleDownloadExcel = () => {
                const wb = XLSX.utils.book_new();
                ['ÏÑ†Î∞úÎåÄ', '2Ìò∏Ï∞®', '3Ìò∏Ï∞®'].forEach(type => {
                    const wsData = [["", type + " Ï¢åÏÑùÌëú", "", "", ""], ["Ï∞ΩÍ∞Ä(Ï¢å)", "ÌÜµÎ°ú(Ï¢å)", "ÌÜµÎ°ú", "ÌÜµÎ°ú(Ïö∞)", "Ï∞ΩÍ∞Ä(Ïö∞)"]];
                    const members = data.filter(p => p.vehicleType === type);
                    for(let r=0; r<13; r++) {
                        const row = [null, null, "", null, null];
                        [0, 1, 2, 3].forEach(c => {
                            const p = members.find(m => m.seatPosition === r*4 + c);
                            row[c < 2 ? c : c + 1] = p ? p.name : "";
                        });
                        wsData.push(row);
                    }
                    XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(wsData), type);
                });
                const other = data.filter(p => ['Í∞úÏù∏Ï∞®Îüâ', 'ÍµêÌöåÏ∞®Îüâ'].includes(p.vehicleType)).map(p => ({ 'Íµ¨Î∂Ñ': p.vehicleType, 'ÏÑ±Ìï®': p.name, 'Ï∂úÎ∞ú': p.departure, 'Í∑ÄÍ∞Ä': p.return, 'Î©îÎ™®': p.details }));
                XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(other), 'Í∞úÏù∏ÍµêÌöåÎ™ÖÎã®');
                XLSX.writeFile(wb, "2026_ÏàòÎ†®Ìöå_Ï∞®ÎüâÌòÑÌô©_ÏµúÏ¢Ö.xlsx");
            };

            const renderBus = (type) => {
                const members = data.filter(p => p.vehicleType === type);
                const s = searchTerm.trim().toLowerCase();
                const maxRow = type === '2Ìò∏Ï∞®' ? 12 : 9;
                return (
                    <div className="bus-container animate-pop mb-4">
                        <div className="flex justify-between items-center mb-3">
                            <h4 className="font-black text-slate-800 text-sm">{type}</h4>
                            <span className="text-[9px] font-bold bg-blue-50 text-blue-600 px-2 py-0.5 rounded-full">{members.length}ÏÑù</span>
                        </div>
                        <div className="flex justify-center gap-1">
                            <div className="grid grid-cols-2 gap-1 flex-1">
                                {Array.from({ length: maxRow }).map((_, r) => [0, 1].map(c => {
                                    const p = members.find(m => m.seatPosition === r*4 + c);
                                    const isMatch = s && p?.name.toLowerCase().includes(s);
                                    return (
                                        <div key={r*4+c} className={`seat ${p ? 'seat-occupied' : 'seat-empty'} ${isMatch ? 'seat-highlight' : ''}`} onClick={() => p && setSelectedItem(p)}>
                                            {p?.name}
                                        </div>
                                    );
                                }))}
                            </div>
                            <div className="aisle"></div>
                            <div className="grid grid-cols-2 gap-1 flex-1">
                                {Array.from({ length: maxRow }).map((_, r) => [2, 3].map(c => {
                                    const p = members.find(m => m.seatPosition === r*4 + c);
                                    const isMatch = s && p?.name.toLowerCase().includes(s);
                                    return (
                                        <div key={r*4+c} className={`seat ${p ? 'seat-occupied' : 'seat-empty'} ${isMatch ? 'seat-highlight' : ''}`} onClick={() => p && setSelectedItem(p)}>
                                            {p?.name}
                                        </div>
                                    );
                                }))}
                            </div>
                        </div>
                    </div>
                );
            };

            const renderTablePrivate = () => {
                const s = searchTerm.trim().toLowerCase();
                const list = data.filter(p => p.vehicleType === 'Í∞úÏù∏Ï∞®Îüâ' && (!s || p.name.toLowerCase().includes(s)))
                    .sort((a, b) => a.groupId.localeCompare(b.groupId) || (b.isDriver ? 1 : -1));
                if (list.length === 0) return null;
                return (
                    <div className="bg-white rounded-xl overflow-hidden shadow-sm border border-slate-200">
                        <table className="info-table">
                            <thead><tr><th>ÏÑ±Ìï®</th><th>ÏùºÏ†ï</th><th>Ï∞®Îüâ/Î©îÎ™®</th></tr></thead>
                            <tbody>
                                {list.map(p => (
                                    <tr key={p.id} onClick={() => setSelectedItem(p)}>
                                        <td className="font-black">{p.name} {p.isDriver && <span className="text-[7px] bg-red-500 text-white px-1 rounded-sm ml-0.5">DR</span>}</td>
                                        <td className="text-emerald-600 font-bold whitespace-nowrap text-[9px]">{p.departure}</td>
                                        <td className="text-slate-400 truncate max-w-[100px] text-[10px]">{p.details}</td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                );
            };

            const renderChurchCards = () => {
                const s = searchTerm.trim().toLowerCase();
                const list = data.filter(p => p.vehicleType === 'ÍµêÌöåÏ∞®Îüâ' && (!s || p.name.toLowerCase().includes(s)))
                    .sort((a, b) => a.groupId.localeCompare(b.groupId));
                if (list.length === 0) return null;

                return (
                    <div className="grid grid-cols-2 gap-2.5">
                        {list.map(p => (
                            <div key={p.id} className="church-card animate-pop" onClick={() => setSelectedItem(p)}>
                                <div className="flex justify-between items-start mb-1.5">
                                    <span className="text-[8px] font-bold text-amber-600 bg-amber-50 px-1.5 py-0.5 rounded-md border border-amber-100">{p.details}</span>
                                </div>
                                <h4 className="text-sm font-black text-slate-800 mb-1.5">{p.name}</h4>
                                <div className="space-y-0.5 text-[9px] border-t pt-1.5 mt-1">
                                    <div className="flex items-center gap-1">
                                        <span className="text-blue-500 font-bold">Ï∂úÎ∞ú</span>
                                        <span className="font-black text-slate-600">{p.departure}</span>
                                    </div>
                                    <div className="flex items-center gap-1">
                                        <span className="text-slate-400 font-bold">Í∑ÄÍ∞Ä</span>
                                        <span className="font-black text-slate-500">{p.return}</span>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>
                );
            };

            return (
                <div className="pb-24 safe-area-bottom">
                    <header className="sticky-header px-4 py-4 border-b border-slate-200 mb-5">
                        <div className="flex justify-between items-center mb-3">
                            <div>
                                <h1 className="text-lg font-black text-slate-900 tracking-tight">2026 Ï∞®ÎüâÏö¥ÏòÅ <span className="text-blue-600 font-black">DASH</span></h1>
                                <p className="text-[9px] font-bold text-slate-400 uppercase">Status & Passenger List</p>
                            </div>
                            <div className="flex gap-1.5">
                                <button onClick={() => setIsAdmin(!isAdmin)} className={`px-2.5 py-1 rounded-full text-[9px] font-black ${isAdmin ? 'bg-slate-800 text-white' : 'bg-slate-200 text-slate-600'}`}>
                                    {isAdmin ? 'ADMIN' : 'VIEW'}
                                </button>
                                <button onClick={handleDownloadExcel} className="p-1.5 bg-emerald-50 text-emerald-600 rounded-lg border border-emerald-100">
                                    <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
                                </button>
                            </div>
                        </div>
                        <input type="text" placeholder="Í≤ÄÏÉâÌï† ÏÑ±Ìï®ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî..." value={searchTerm} onChange={e => setSearchTerm(e.target.value)} className="w-full h-10 bg-white border-2 border-slate-200 rounded-xl px-4 font-bold text-sm outline-none focus:border-blue-500 shadow-sm" />
                    </header>

                    <main className="px-4 space-y-8">
                        {isAdmin && (
                            <section className="bg-slate-800 p-5 rounded-2xl shadow-lg text-white">
                                <h3 className="text-[10px] font-black opacity-60 mb-3 tracking-widest uppercase">Ïã†Í∑ú Îç∞Ïù¥ÌÑ∞ Ï∂îÍ∞Ä</h3>
                                <form onSubmit={e => { e.preventDefault(); if(!form.name) return; setData([...data, {id:Date.now(), ...form, seatPosition:0, groupId: `g-${Date.now()}`}]); setForm({...form, name:''}); }} className="space-y-2">
                                    <input type="text" placeholder="ÏÑ±Ìï®" value={form.name} onChange={e => setForm({...form, name: e.target.value})} className="w-full h-10 px-3 bg-white/5 border border-white/10 rounded-lg font-bold text-sm" />
                                    <select value={form.vehicle} onChange={e => setForm({...form, vehicle: e.target.value})} className="w-full h-10 px-3 bg-white/5 border border-white/10 rounded-lg font-bold text-xs">{['ÏÑ†Î∞úÎåÄ', '2Ìò∏Ï∞®', '3Ìò∏Ï∞®', 'Í∞úÏù∏Ï∞®Îüâ', 'ÍµêÌöåÏ∞®Îüâ'].map(v => <option key={v} className="text-black">{v}</option>)}</select>
                                    <div className="grid grid-cols-2 gap-2">
                                        <select value={form.dep} onChange={e => setForm({...form, dep: e.target.value})} className="h-10 px-2 bg-white/5 border border-white/10 rounded-lg font-bold text-[9px]">{TIME_OPTIONS.map(t => <option key={t} className="text-black">{t}</option>)}</select>
                                        <select value={form.ret} onChange={e => setForm({...form, ret: e.target.value})} className="h-10 px-2 bg-white/5 border border-white/10 rounded-lg font-bold text-[9px]">{TIME_OPTIONS.map(t => <option key={t} className="text-black">{t}</option>)}</select>
                                    </div>
                                    <button className="w-full h-10 bg-blue-500 text-white rounded-lg font-black text-sm">Ï∂îÍ∞Ä ÏôÑÎ£å</button>
                                </form>
                            </section>
                        )}

                        <section>
                            <h2 className="text-base font-black mb-4 flex items-center gap-2 text-slate-700">üöå Î≤ÑÏä§ Ï¢åÏÑù Î∞∞Ïπò</h2>
                            <div className="grid grid-cols-1 gap-4">
                                {renderBus('ÏÑ†Î∞úÎåÄ')}{renderBus('2Ìò∏Ï∞®')}{renderBus('3Ìò∏Ï∞®')}
                            </div>
                        </section>

                        <section>
                            <h2 className="text-base font-black mb-4 flex items-center gap-2 text-slate-700">üöó Í∞úÏù∏Ï∞®Îüâ Ïù¥Îèô Î™ÖÎã®</h2>
                            {renderTablePrivate()}
                        </section>

                        <section>
                            <h2 className="text-base font-black mb-4 flex items-center gap-2 text-slate-700">üöê ÍµêÌöåÏ∞®Îüâ ÏÉÅÏÑ∏ Ïù¥Îèô</h2>
                            {renderChurchCards()}
                        </section>
                    </main>

                    {selectedItem && (
                        <div className="fixed inset-0 z-[100] flex items-end sm:items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm" onClick={() => setSelectedItem(null)}>
                            <div className="bg-white w-full max-w-sm rounded-t-[32px] sm:rounded-[32px] shadow-2xl p-6 animate-pop" onClick={e => e.stopPropagation()}>
                                <div className="flex justify-between items-start mb-5">
                                    <div>
                                        <h2 className="text-2xl font-black text-slate-900">{selectedItem.name}</h2>
                                        <span className="text-[10px] font-bold text-blue-600 bg-blue-50 px-2 py-0.5 rounded-full mt-1 inline-block">{selectedItem.vehicleType}</span>
                                    </div>
                                    <button onClick={() => setSelectedItem(null)} className="p-2 bg-slate-50 rounded-full text-slate-400">‚úï</button>
                                </div>
                                <div className="space-y-3 mb-6">
                                    <div className="p-3 bg-slate-50 rounded-xl">
                                        <p className="text-[10px] font-bold text-slate-400 mb-0.5">Ï∂úÎ∞ú ÏùºÏ†ï/ÏãúÍ∞Ñ</p>
                                        <p className="text-sm font-black text-slate-800">{selectedItem.departure}</p>
                                    </div>
                                    <div className="p-3 bg-slate-50 rounded-xl">
                                        <p className="text-[10px] font-bold text-slate-400 mb-0.5">Í∑ÄÍ∞Ä ÏùºÏ†ï/ÏãúÍ∞Ñ</p>
                                        <p className="text-sm font-black text-slate-800">{selectedItem.return}</p>
                                    </div>
                                    <div className="p-3 bg-slate-50 rounded-xl">
                                        <p className="text-[10px] font-bold text-slate-400 mb-0.5">ÏÉÅÏÑ∏ ÎÇ¥Ïö©</p>
                                        <p className="text-xs font-bold text-slate-600 leading-relaxed">{selectedItem.details || 'ÏóÜÏùå'}</p>
                                    </div>
                                </div>
                                {isAdmin && (
                                    <button onClick={() => { setData(d => d.filter(p => p.id !== selectedItem.id)); setSelectedItem(null); }} className="w-full h-12 bg-red-50 text-red-500 rounded-xl font-black text-sm border border-red-100 mb-2">ÏÇ≠Ï†úÌïòÍ∏∞</button>
                                )}
                                <button onClick={() => setSelectedItem(null)} className="w-full h-12 bg-slate-900 text-white rounded-xl font-black text-sm">Îã´Í∏∞</button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
